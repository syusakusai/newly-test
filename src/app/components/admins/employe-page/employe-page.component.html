<div
  *ngIf="deleteMessage"
  class="fixed top-6 left-1/2 transform -translate-x-1/2 flex items-center justify-center z-50"
>
  <div
    class="flex items-center max-w-xs p-4 text-red-700 bg-red-100 rounded-lg shadow-lg"
    role="alert"
  >
    <svg
      class="w-6 h-6 mr-2 text-red-500"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M6 18L18 6M6 6l12 12"
      />
    </svg>
    <span class="text-sm font-medium">{{ deleteMessage }}</span>
  </div>
</div>

<div class="overflow-x-auto mt-6">
  <div class="mb-4 flex flex-wrap gap-4 items-center">
    <input
      type="text"
      [(ngModel)]="filterUsername"
      (input)="applyFilter()"
      placeholder="Filter by Username"
      class="px-3 py-2 border rounded w-64 text-sm"
    />
    <input
      type="text"
      [(ngModel)]="filterFirstName"
      (input)="applyFilter()"
      placeholder="Filter by First Name"
      class="px-3 py-2 border rounded w-64 text-sm"
    />
  </div>
  <div class="flex justify-end mb-4">
    <button
      (click)="showAddModal = true"
      class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-50"
    >
      Add Employee
    </button>
  </div>
  <table class="min-w-full bg-white border border-gray-200 rounded-lg shadow">
    <thead>
      <tr class="bg-gray-100">
        <th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">
          Username
        </th>
        <th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">
          First Name
        </th>
        <th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">
          Last Name
        </th>
        <th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">
          Email
        </th>
        <th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">
          Birth Date
        </th>
        <th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">
          Basic Salary
        </th>
        <th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">
          Status
        </th>
        <th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">
          Group
        </th>
        <th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">
          Description
        </th>
        <th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">
          Actions
        </th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let emp of pagedEmployees" class="border-t">
        <td class="px-4 py-2 text-sm text-gray-600">{{ emp.username }}</td>
        <td class="px-4 py-2 text-sm text-gray-600">{{ emp.firstName }}</td>
        <td class="px-4 py-2 text-sm text-gray-600">{{ emp.lastName }}</td>
        <td class="px-4 py-2 text-sm text-gray-600">{{ emp.email }}</td>
        <td class="px-4 py-2 text-sm text-gray-600">{{ emp.birthDate }}</td>
        <td class="px-4 py-2 text-sm text-gray-600">
          {{ emp.basicSalary }}
        </td>
        <td class="px-4 py-2 text-sm text-gray-600">{{ emp.status }}</td>
        <td class="px-4 py-2 text-sm text-gray-600">{{ emp.group }}</td>
        <td class="px-4 py-2 text-sm text-gray-600">{{ emp.description }}</td>
        <td class="px-4 py-2 text-sm text-gray-600">
          <button
            (click)="openDetailModal(emp)"
            class="px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600 mr-2"
          >
            Detail
          </button>
          <button
            (click)="deleteEmployee(emp)"
            class="px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600"
          >
            Delete
          </button>
        </td>
      </tr>
    </tbody>
  </table>
  <div class="flex justify-center items-center mt-4 space-x-2">
    <button
      class="px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:cursor-not-allowed disabled:bg-gray-100 disabled:text-gray-400"
      [disabled]="currentPage === 1"
      (click)="setPage(1)"
    >
      First
    </button>
    <button
      class="px-3 py-1 bg-gray-200 rounded hover:bg-gray-300"
      [disabled]="currentPage === 1"
      (click)="setPage(currentPage - 1)"
    >
      Prev
    </button>
    <span class="px-3 py-1">{{ currentPage }} / {{ totalPages }}</span>
    <button
      class="px-3 py-1 bg-gray-200 rounded hover:bg-gray-300"
      [disabled]="currentPage === totalPages"
      (click)="setPage(currentPage + 1)"
    >
      Next
    </button>
    <button
      class="px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:cursor-not-allowed disabled:bg-gray-100 disabled:text-gray-400"
      [disabled]="currentPage === totalPages"
      (click)="setPage(totalPages)"
    >
      Last
    </button>
    <div class="flex justify-between items-center mt-4 mb-2">
      <div></div>
      <div>
        <label for="pageSize" class="mr-2 text-sm text-gray-700"
          >Rows per page:</label
        >
        <select
          id="pageSize"
          [(ngModel)]="pageSize"
          (change)="onPageSizeChange()"
          class="px-2 py-1 border rounded text-sm"
        >
          <option *ngFor="let size of [5, 10, 20, 50]" [value]="size">
            {{ size }}
          </option>
        </select>
        <!-- <p>berapa ?  {{ pagedEmployees.length }} rows</p> -->
      </div>
    </div>
  </div>
</div>

<!-- modal -->

<div
  *ngIf="showAddModal"
  class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50"
>
  <div class="bg-white p-6 rounded shadow-lg w-full max-w-lg relative">
    <button
      (click)="showAddModal = false"
      class="absolute top-2 right-2 text-gray-500 hover:text-gray-700 text-xl"
    >
      &times;
    </button>
    <h2 class="text-lg font-semibold mb-4">Add Employee</h2>
    <form
      (ngSubmit)="addEmployee()"
      #empForm="ngForm"
      class="flex flex-wrap gap-4"
    >
      <input
        type="text"
        [(ngModel)]="newEmployee.username"
        name="username"
        placeholder="Username"
        required
        class="px-3 py-2 border rounded w-40 text-sm"
      />
      <input
        type="text"
        [(ngModel)]="newEmployee.firstName"
        name="firstName"
        placeholder="First Name"
        required
        class="px-3 py-2 border rounded w-40 text-sm"
      />
      <input
        type="text"
        [(ngModel)]="newEmployee.lastName"
        name="lastName"
        placeholder="Last Name"
        required
        class="px-3 py-2 border rounded w-40 text-sm"
      />
      <input
        type="email"
        [(ngModel)]="newEmployee.email"
        name="email"
        placeholder="Email"
        required
        class="px-3 py-2 border rounded w-40 text-sm"
      />
      <input
        type="date"
        [(ngModel)]="newEmployee.birthDate"
        name="birthDate"
        required
        class="px-3 py-2 border rounded w-40 text-sm"
      />
      <input
        type="number"
        [(ngModel)]="newEmployee.basicSalary"
        name="basicSalary"
        placeholder="Basic Salary"
        required
        class="px-3 py-2 border rounded w-40 text-sm"
      />
      <input
        type="text"
        [(ngModel)]="newEmployee.status"
        name="status"
        placeholder="Status"
        required
        class="px-3 py-2 border rounded w-40 text-sm"
      />
      <input
        type="text"
        [(ngModel)]="newEmployee.group"
        name="group"
        placeholder="Group"
        required
        class="px-3 py-2 border rounded w-40 text-sm"
      />
      <input
        type="text"
        [(ngModel)]="newEmployee.description"
        name="description"
        placeholder="Description"
        class="px-3 py-2 border rounded w-40 text-sm"
      />
      <button
        type="submit"
        [disabled]="empForm.invalid"
        class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
      >
        Add
      </button>
    </form>
  </div>
</div>

<!-- delete message -->

<!-- Place this after your add modal -->
<div
  *ngIf="showDetailModal"
  class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50"
>
  <div class="bg-white p-6 rounded shadow-lg w-full max-w-lg relative">
    <button
      (click)="showDetailModal = false"
      class="absolute top-2 right-2 text-gray-500 hover:text-gray-700 text-xl"
    >
      &times;
    </button>
    <h2 class="text-lg font-semibold mb-4">Employee Detail</h2>
    <div class="flex flex-wrap gap-4">
      <div class="w-40">
        <label class="block text-xs text-gray-500">Username</label>
        <div class="px-3 py-2 border rounded text-sm bg-gray-100">
          {{ selectedEmployee?.username }}
        </div>
      </div>
      <div class="w-40">
        <label class="block text-xs text-gray-500">First Name</label>
        <div class="px-3 py-2 border rounded text-sm bg-gray-100">
          {{ selectedEmployee?.firstName }}
        </div>
      </div>
      <div class="w-40">
        <label class="block text-xs text-gray-500">Last Name</label>
        <div class="px-3 py-2 border rounded text-sm bg-gray-100">
          {{ selectedEmployee?.lastName }}
        </div>
      </div>
      <div class="w-40">
        <label class="block text-xs text-gray-500">Email</label>
        <div class="px-3 py-2 border rounded text-sm bg-gray-100">
          {{ selectedEmployee?.email }}
        </div>
      </div>
      <div class="w-40">
        <label class="block text-xs text-gray-500">Birth Date</label>
        <div class="px-3 py-2 border rounded text-sm bg-gray-100">
          {{ selectedEmployee?.birthDate }}
        </div>
      </div>
      <div class="w-40">
        <label class="block text-xs text-gray-500">Basic Salary</label>
        <div class="px-3 py-2 border rounded text-sm bg-gray-100">
          {{ selectedEmployee?.basicSalary }}
        </div>
      </div>
      <div class="w-40">
        <label class="block text-xs text-gray-500">Status</label>
        <div class="px-3 py-2 border rounded text-sm bg-gray-100">
          {{ selectedEmployee?.status }}
        </div>
      </div>
      <div class="w-40">
        <label class="block text-xs text-gray-500">Group</label>
        <div class="px-3 py-2 border rounded text-sm bg-gray-100">
          {{ selectedEmployee?.group }}
        </div>
      </div>
      <div class="w-40">
        <label class="block text-xs text-gray-500">Description</label>
        <div class="px-3 py-2 border rounded text-sm bg-gray-100">
          {{ selectedEmployee?.description }}
        </div>
      </div>
    </div>
  </div>
</div>
